var surveyObject={surveyName:"",questionArray:[],team:"",comments:""},surveyCreator={toggleQuestion:function(){$("div.surveyTools > button").each(function(){var a=$("div.surveyTools > div"),b=$(this).attr("class").split(" "),c=b[b.length-1],d=$("div.surveyTools > div."+c);$(this).on("click",function(){a.addClass("hide"),d.removeClass("hide")})})},addChoice:function(){$('button[name="add"]').unbind().on("click",function(){var a=(document.getElementById("choicesForm"),this.parentNode,document.getElementsByName("add"),document.createElement("input")),b=document.createElement("input"),c=document.createElement("div");a.name="inputvalue",a.type="text",a.placeholder="Choice",b.name="del",b.type="button",b.value="Delete",b.className="btn btn-default btn-xs",c.appendChild(a),c.appendChild(b),$('button[name="add"]').before(c),$('add[name="inputvalue"]').unbind().on("change",function(){$(this).data("name",$(this).val())})})},addEditChoice:function(){$("html").unbind().on("click",'button[name="editAdd"]',function(){var a=document.createElement("div"),b=document.createElement("input"),c=document.createElement("input");b.name="editAnswer",b.type="text",c.name="del",c.type="Button",c.value="Delete",c.classname="btn btn-default btn-xs",a.appendChild(b),a.appendChild(c),$('button[name="editAdd"]').before(a),$('input[name="editAnswer"]').unbind().on("change",function(){$(this).data("name",$(this).val())})})},questionType:function(){$("#saveCheckbox").on("click",function(){surveyCreator.addQuestion("checkbox")}),$("#saveRadio").on("click",function(){surveyCreator.addQuestion("radio")}),$("#saveDroplist").on("click",function(){surveyCreator.addQuestion("select")}),$("#saveTextarea").on("click",function(){surveyCreator.addQuestion("textarea")}),$("#saveText").on("click",function(){surveyCreator.addQuestion("text")}),$("#saveNumber").on("click",function(){surveyCreator.addQuestion("number")})},addQuestion:function(a){var b=document.getElementById("surveyContainer"),c={questionName:String,answerArray:new Array},d=document.createElement("div"),e=document.createElement("div"),f=document.createElement("button"),g=document.createElement("button"),h=document.createElement("button"),i=document.createElement("button"),j=document.createElement("div");if(d.className="col-md-5",e.className="col-md-3",j.name="sElement",j.className="row",j.display="inline",f.innerHTML="Edit",f.className="btn btn-xs",f.name="edit",f.type="button",g.innerHTML="Delete",g.className="btn btn-xs",g.name="del",g.type="button",h.innerHTML="^",h.className="btn btn-xs",h.name="up",h.type="button",i.innerHTML="v",i.className="btn btn-xs",i.name="down",i.type="button",e.appendChild(f),e.appendChild(g),e.appendChild(h),e.appendChild(i),"checkbox"==a)$('#editCheckbox input[name="questionName"]').each(function(){var a=document.createElement("h3");a.innerHTML=$(this).val(),c.questionName=$(this).val(),j.appendChild(a)}),$('#editCheckbox input[name="inputvalue"]').each(function(){var b=document.createElement("input"),e=document.createElement("label");c.type=a,c.answerArray.push($(this).val()),b.name=c.questionName,b.type=a,b.value=$(this).val(),b.disabled="disabled",e.innerHTML=$(this).val(),d.appendChild(e),d.appendChild(b),j.appendChild(d)}),j.appendChild(e),b.appendChild(j);else if("radio"==a)$('#editRadio input[name="questionName"]').each(function(){var a=document.createElement("h3");a.innerHTML=$(this).val(),c.questionName=$(this).val(),j.appendChild(a)}),$('#editRadio input[name="inputvalue"]').each(function(){var b=document.createElement("input"),e=document.createElement("label");c.type=a,c.answerArray.push($(this).val()),b.name=c.questionName,b.type=a,b.value=$(this).val(),b.disabled="disabled",e.innerHTML=$(this).val(),d.appendChild(e),d.appendChild(b),j.appendChild(d)}),j.appendChild(e),b.appendChild(j);else if("text"==a){$('#editText input[name="questionName"]').each(function(){var b=document.createElement("h3");b.innerHTML=$(this).val(),c.questionName=$(this).val(),c.type=a,j.appendChild(b)});var k=document.createElement("input");k.name=c.questionName,k.disabled="disabled",d.appendChild(k),j.appendChild(d),j.appendChild(e),b.appendChild(j)}else if("textarea"==a){$('#editTextarea input[name="questionName"]').each(function(){var b=document.createElement("h3");b.innerHTML=$(this).val(),c.questionName=$(this).val(),c.type=a,j.appendChild(b)});var k=document.createElement("textarea");k.name=c.questionName,k.disabled="disabled",d.appendChild(k),j.appendChild(d),j.appendChild(e),b.appendChild(j)}else if("select"==a){$('#editDroplist input[name="questionName"]').each(function(){var a=document.createElement("h3");a.innerHTML=$(this).val(),c.questionName=$(this).val(),j.appendChild(a)});var k=document.createElement("select");k.name=c.questionName,k.disabled="disabled",d.appendChild(k),$('#editDroplist input[name="inputvalue"]').each(function(){var b=document.createElement("option");b.innerHTML=$(this).val(),c.type=a,c.answerArray.push($(this).val()),k.appendChild(b)}),j.appendChild(d),j.appendChild(e),b.appendChild(j)}j.dataset.qobj=JSON.stringify(c)},removeChoice:function(){$("html").on("click",'input[name="del"]',function(){$(this).parent().remove()})},removeElement:function(){$("html").on("click",'button[name="del"]',function(){$(this).parent().parent().remove()})},editElement:function(){$("html").on("click",'button[name="edit"]',function(){var a=$(this).parent().parent().data("qobj"),b=document.createElement("button"),c=document.createElement("button"),d=document.createElement("button"),e=document.createElement("div"),f=document.createElement("input");if($('button[name="edit"]').attr("disabled",!0),$('button[name="del"').attr("disabled",!0),$('button[name="up"]').attr("disabled",!0),$('button[name="down"').attr("disabled",!0),e.name="editDiv",b.innerHTML="+",b.type="button",b.name="editAdd",c.type="button",c.name="saveChanges",d.type="button",d.name="closeEdit",d.innerHTML="Close",c.innerHTML="Save Changes",f.name="editQuestion",f.value=a.questionName,e.appendChild(f),"text"==a.type||"textarea"==a.type)$(this).parent().parent().after(e),e.appendChild(document.createElement("br")),e.appendChild(d),e.appendChild(c);else{for(answer in a.answerArray){var g=document.createElement("input"),h=document.createElement("div"),i=document.createElement("input");i.name="del",i.type="button",i.className="btn btn-default btn-xs",i.value="Delete",g.name="editAnswer",g.value=a.answerArray[answer],h.appendChild(g),h.appendChild(i),e.appendChild(h)}e.appendChild(b),e.appendChild(document.createElement("br")),e.appendChild(d),e.appendChild(c),$(this).parent().parent().after(e)}})},moveUp:function(){$("html").on("click",'button[name="up"]',function(){$(this).parent().parent().insertBefore($(this).parent().parent().prev())})},moveDown:function(){$("html").on("click",'button[name="down"]',function(){$(this).parent().parent().insertAfter($(this).parent().parent().next())})},saveLast:function(){var a={questionName:"",answerArray:[]},b=document.createElement("div");$('input[name="editQuestion"').each(function(){a.questionName=$(this).val()}),$('input[name="editAnswer"]').each(function(){a.answerArray.push($(this).val())}),$(this).parent().prev().children().remove(".col-md-5"),$(this).parent().prev().children("h3").html(a.questionName);var c=$(this).parent().prev().data("qobj").type,d=$(this).parent().prev();if(a.type=c,b.className="col-md-5","checkbox"==c||"radio"==c){for(answer in a.answerArray){var e=document.createElement("input"),f=document.createElement("label");e.name=a.questionName,e.type=c,e.disabled="disabled",f.innerHTML=a.answerArray[answer],b.appendChild(f),b.appendChild(e)}d.children(".col-md-3").before(b)}else if("select"==c){var e=document.createElement("select");e.name=a.questionName,e.disabled="disabled";for(answer in a.answerArray){var g=document.createElement("option");g.innerHTML=a.answerArray[answer],e.appendChild(g)}b.appendChild(e),d.children(".col-md-3").before(b)}else if("text"==c){var e=document.createElement("input");e.name=a.questionName,b.appendChild(e),d.children(".col-md-3").before(b)}else if("textarea"==c){var h=document.createElement("textarea");e.name=a.questionName,b.appendChild(h),d.children(".col-md-3").before(b)}console.log(a),$(this).parent().prev().data("qobj",a),$(this).parent().remove(),$('button[name="edit"]').attr("disabled",!1),$('button[name="del"]').attr("disabled",!1),$('button[name="up"]').attr("disabled",!1),$('button[name="down"]').attr("disabled",!1)},closeEdit:function(){$("html").on("click",'button[name="closeEdit"]',function(){$(this).parent().remove(),$('button[name="edit"]').attr("disabled",!1),$('button[name="del"]').attr("disabled",!1),$('button[name="up"]').attr("disabled",!1),$('button[name="down"]').attr("disabled",!1)})},saveChanges:function(){$("html").on("click",'button[name="saveChanges"]',surveyCreator.saveLast)},submitSurvey:function(){surveyObject.team=$("#teamselect option:selected").val(),$("#surveyName").on("change",function(){surveyObject.surveyName=$(this).val()}),$("#teamselect").on("change",function(){surveyObject.team=$("#teamselect option:selected").val()}),$("#saveSurvey").on("click",function(){$('button[name="saveChanges"]').each(function(){$(this).click()}),surveyObject.questionArray=[],$("#surveyContainer > .row").each(function(){surveyObject.questionArray.push($(this).data("qobj"))}),console.log(surveyObject),surveyCreator.postJSON(surveyObject)})},postJSON:function(){$.ajax({type:"POST",url:"",data:surveyObject,success:function(){window.location.href="/"}})},loadSurvey:function(){var a=0;if("undefined"!=typeof surveyCollection){var b={questionName:String,answerArray:new Array};console.log(surveyCollection);var c=document.getElementById("surveyContainer"),d=surveyCollection.surveyName,e=surveyCollection.questions;document.getElementById("surveyName").value=d;for(question in e){var f=document.createElement("div"),g=document.createElement("div"),h=document.createElement("h3"),i=document.createElement("button"),j=document.createElement("button"),k=document.createElement("button"),l=document.createElement("button"),m=e[question].type;if(f.className="row",i.innerHTML="Edit",i.className="btn btn-xs",i.name="edit",i.type="button",j.innerHTML="Delete",j.className="btn btn-xs",j.name="del",j.type="button",k.innerHTML="^",k.className="btn btn-xs",k.name="up",k.type="button",l.innerHTML="v",l.className="btn btn-xs",l.name="down",l.type="button",g.className="col-md-3",h.innerHTML=e[question].questionName,b.questionName=e[question].questionName,b.type=m,g.appendChild(i),g.appendChild(j),g.appendChild(k),g.appendChild(l),f.appendChild(h),"checkbox"==m||"radio"==m){var n=document.createElement("div");for(answer in e[question].answerArray){console.log(e[question].answerArray[answer]);var o=document.createElement("input"),p=document.createElement("label");n.className="col-md-5",o.type=m,o.disabled="disabled",p.innerHTML=e[question].answerArray[answer],b.answerArray.push(e[question].answerArray[answer]),n.appendChild(o),n.appendChild(p)}f.appendChild(n)}else if("select"==m){var q=document.createElement("div"),r=document.createElement("select");r.name="select"+a,r.disabled="disabled";for(answer in e[question].answerArray){var s=document.createElement("option");q.className="col-md-5",s.innerHTML=e[question].answerArray[answer],r.appendChild(s),b.answerArray.push(e[question].answerArray[answer])}q.appendChild(r),f.appendChild(q)}else if("text"==m){var o=document.createElement("input");o.name="input"+a;var q=document.createElement("div");o.disabled="disabled",q.className="col-mid-5",q.appendChild(o),f.appendChild(q)}else if("textarea"==m){var t=document.createElement("textarea");t.name="textarea"+a;var q=document.createElement("div");q.className="col-mid-5",t.disabled="disabled",q.appendChild(t),f.appendChild(q)}f.dataset.qobj=JSON.stringify(b),f.appendChild(g),c.appendChild(f),b.answerArray=[]}}},init:jQuery(function(){surveyCreator.toggleQuestion(),surveyCreator.addChoice(),surveyCreator.addEditChoice(),surveyCreator.questionType(),surveyCreator.removeChoice(),surveyCreator.removeElement(),surveyCreator.editElement(),surveyCreator.closeEdit(),surveyCreator.moveUp(),surveyCreator.moveDown(),surveyCreator.saveChanges(),surveyCreator.submitSurvey(),surveyCreator.loadSurvey()})};jQuery(function(a){a(".modal.fade.no-trigger").modal()});